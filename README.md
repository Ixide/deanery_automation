# Автоматизация документооборота деканата

## Описание проекта

Веб-приложение, разработанное в рамках учебного проекта, для автоматизации генерации учебной документации в деканате. Приложение использует возможности искусственного интеллекта (Google Gemini API) для создания силлабусов и экзаменационных билетов. Особенностью генерации силлабусов является использование предварительно созданного DOCX-шаблона, который программа заполняет данными, сгенерированными ИИ, включая динамическое добавление строк в таблицы (например, для тематического плана). Также реализована возможность скачивания сгенерированных документов в формате `.docx`.

## Основные возможности

* **Генерация силлабусов с помощью ИИ на основе DOCX-шаблона:**
    * Автоматическое заполнение DOCX-шаблона силлабуса данными, сгенерированными Google Gemini API (описание курса, результаты обучения, индикаторы, пререквизиты, постреквизиты, тематический план, литература и др.).
    * Динамическое добавление строк в таблицу тематического плана в DOCX-шаблоне в зависимости от количества тем, сгенерированных ИИ.
    * Поддержка плейсхолдеров в DOCX-шаблоне для вставки данных.
* **Генерация экзаменационных билетов с помощью ИИ:**
    * Создание комплекта экзаменационных билетов по указанной дисциплине и темам (генерируется с нуля, без использования DOCX-шаблона для билетов).
    * Формирование теоретических вопросов и практических заданий.
* **Экспорт документов:**
    * Возможность скачивания сгенерированных силлабусов (из заполненного шаблона) и экзаменационных билетов в формате `.docx`.
* **Веб-интерфейс:**
    * Простой интерфейс для ввода исходных данных (название дисциплины, специальность, образовательные цели, темы для билетов) и получения результатов.

## Технологии

* **Бэкенд:**
    * Java 21
    * Spring Boot 3.x (включая Spring Web, Spring Data MongoDB)
    * Google Gemini API (для генерации контента)
    * Apache POI (для чтения DOCX-шаблона и его модификации, а также для создания DOCX экзаменационных билетов с нуля)
* **База данных:**
    * MongoDB
* **Фронтенд:**
    * Thymeleaf (шаблонизатор)
    * HTML5, CSS3
    * Bootstrap 5 (для базовой стилизации)
* **Система сборки:**
    * Maven (с использованием Maven Wrapper)
* **Контроль версий:**
    * Git, GitHub

## Настройка и запуск проекта

### Предварительные требования:

1.  **Java Development Kit (JDK):** Версия 21 или выше.
2.  **MongoDB:** Установленный и запущенный сервер MongoDB.
3.  **API Ключ Google Gemini:** Необходимо получить API ключ для доступа к Gemini API.
4.  **DOCX-шаблон силлабуса:** Файл `syllabus_template.docx` (или с вашим названием) должен находиться в директории `src/main/resources/templates/docx_templates/`. Этот шаблон должен содержать необходимые плейсхолдеры.
5.  **Maven:** (Опционально, если не используется Maven Wrapper) Установленный Apache Maven.
6.  **Git:** Для клонирования репозитория.

### Шаги для запуска:

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL_вашего_репозитория_на_GitHub>
    cd <папка_проекта>
    ```

2.  **Настройте `application.properties`:**
    Создайте файл `src/main/resources/application.properties` (если его нет, можно скопировать из `application.properties.example`, если вы его создадите) со следующим содержимым:

    ```properties
    # MongoDB Configuration
    spring.data.mongodb.uri=mongodb://localhost:27017/deans_office_db # Замените, если необходимо

    # Gemini API Configuration
    gemini.api.key=ВАШ_GEMINI_API_KEY # ЗАМЕНИТЕ НА ВАШ КЛЮЧ!
    gemini.api.url=[https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent](https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent) # Убедитесь, что URL актуален

    # Server Port (optional, default is 8080)
    server.port=8088

    # Thymeleaf settings (optional, for development)
    spring.thymeleaf.cache=false
    ```
    **ВАЖНО:** Замените `ВАШ_GEMINI_API_KEY` на ваш реальный API ключ. **Никогда не добавляйте файл `application.properties` с реальным API ключом в систему контроля версий (Git)!** Убедитесь, что он указан в вашем файле `.gitignore`.

3.  **Убедитесь в наличии DOCX-шаблона:** Поместите ваш файл `syllabus_template.docx` в `src/main/resources/templates/docx_templates/`. В коде `DocxExportService.java` константа `SYLLABUS_TEMPLATE_PATH` указывает на этот путь.

4.  **Сборка и запуск приложения:**
    * **Через Maven Wrapper (рекомендуется):**
        В корневой папке проекта выполните:
        ```bash
        # Для Linux/macOS
        ./mvnw spring-boot:run
        # Для Windows
        mvnw.cmd spring-boot:run
        ```
    * **Через вашу IDE (например, IntelliJ IDEA):**
        Откройте проект в IDE и запустите главный класс `DeansOfficeAutomationApplication.java`.

5.  **Доступ к приложению:**
    После успешного запуска откройте веб-браузер и перейдите по адресу: `http://localhost:8088` (или порт, который вы указали в `server.port`).

## Использование

1.  На главной странице выберите желаемое действие: "Генерация Силлабуса" или "Генерация Экзаменационных Билетов".
2.  Заполните предложенные формы необходимыми данными.
3.  Нажмите кнопку "Сгенерировать".
4.  Результат будет отображен на веб-странице.
5.  Для сгенерированных документов будет доступна кнопка "Скачать DOCX" для загрузки файла.

## Структура проекта (Основные директории)

deans-office-automation/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── kz/yourname/deansoffice/  # Базовый пакет
│   │   │       ├── config/               # Конфигурационные классы (AppConfig)
│   │   │       ├── controller/           # Веб-контроллеры (DocumentController)
│   │   │       ├── dto/                  # Data Transfer Objects (SyllabusRequest, ExamTicketRequest)
│   │   │       ├── model/                # Модели данных (Syllabus, ExamTicket, ThematicPlanModule и др.)
│   │   │       ├── repository/           # Репозитории Spring Data MongoDB
│   │   │       ├── service/              # Сервисы (DocumentGenerationService, DocxExportService, GeminiService)
│   │   │       └── DeansOfficeAutomationApplication.java # Главный класс
│   │   └── resources/
│   │       ├── static/                 # Статические ресурсы (CSS, JS)
│   │       ├── templates/              # Шаблоны Thymeleaf (HTML)
│   │       │   └── docx_templates/     # Папка для DOCX-шаблонов
│   │       │       └── syllabus_template.docx # Ваш шаблон силлабуса
│   │       └── application.properties  # Конфигурация приложения
├── .gitignore                # Игнорируемые файлы для Git
├── pom.xml                   # Файл конфигурации Maven
└── README.md                 # Этот файл

 Возможные доработки (To-Do / Future Enhancements)

* [ ] Улучшение качества и гибкости парсинга ответов от Gemini API.
* [ ] Более продвинутое форматирование DOCX документов, создаваемых программно (например, для экзаменационных билетов или для сложных элементов силлабуса, если отход от шаблона будет необходим).
* [ ] Добавление поддержки генерации других типов учебных документов.
* [ ] Внедрение системы аутентификации и авторизации пользователей.
* [ ] Написание Unit и интеграционных тестов.
* [ ] Добавление возможности загрузки DOCX-шаблона через интерфейс.
* [ ] Улучшение пользовательского интерфейса.

---

Автор: Курмангазин Еламан
Дата: Май 2025 г.
